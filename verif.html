<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>Verifikasi Dokumen D"PLan</title>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsSHA/3.2.0/sha.js"></script>

    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 700px;
            margin: 40px auto;
            line-height: 1.6;
        }
        h1 {
            text-align: center;
            margin-bottom: 5px;
        }
        .sub {
            text-align: center;
            margin-bottom: 20px;
        }
        .alert {
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            text-align: center;
            font-size: 17px;
        }
        .success {
            background: #e1f7e7;
            border: 1px solid #3aa85c;
            color: #247a3f;
        }
        .error {
            background: #ffe3e3;
            border: 1px solid #cc4b4b;
            color: #9b1f1f;
        }
    </style>
</head>

<body>

<h1>Verifikasi Keaslian Laporan</h1>
<div class="sub">Mengecek apakah dokumen ini asli dan tidak dimodifikasi.</div>

<div id="result"></div>

<script>
function getParams() {
    const url = new URL(window.location.href);
    return {
        sv: url.searchParams.get("sv"),
        hash: url.searchParams.get("hash")
    };
}

function verify() {
    const p = getParams();

    if (!p.sv || !p.hash) {
        document.getElementById("result").innerHTML = `
            <div class="alert error">
                Parameter tidak lengkap. QR code mungkin rusak.
            </div>`;
        return;
    }

    const shaObj = new jsSHA("SHA-256", "TEXT");
    shaObj.update(p.sv);
    const calculated = shaObj.getHash("HEX");

    if (calculated === p.hash) {
        document.getElementById("result").innerHTML = `
            <div class="alert success">
                Dokumen Asli ✔️<br>
                Valid dan tidak dimodifikasi.
            </div>`;
    } else {
        document.getElementById("result").innerHTML = `
            <div class="alert error">
                Tidak Valid ❌<br>
                Dokumen kemungkinan telah diubah.
            </div>`;
    }
}

verify();
</script>

</body>
</html>

